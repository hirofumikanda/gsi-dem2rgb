# å›½åœŸåœ°ç†é™¢ æ¨™é«˜ã‚¿ã‚¤ãƒ«ï¼ˆTXTï¼‰â†’ Mapbox Terrain-RGB å¤‰æ›ãƒ„ãƒ¼ãƒ«

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€å›½åœŸåœ°ç†é™¢ãŒæä¾›ã™ã‚‹æ¨™é«˜ãƒ†ã‚­ã‚¹ãƒˆã‚¿ã‚¤ãƒ«ï¼ˆ`.txt`ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€Mapbox Terrain-RGB å½¢å¼ã® PNG ã‚¿ã‚¤ãƒ«ï¼ˆ`{z}/{x}/{y}.png`ï¼‰ã«å¤‰æ›ã™ã‚‹ Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚  
ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¤ãƒ«ã¯ MapLibre GL JS ã‚„ Mapbox GL JS ç­‰ã§ã®åœ°å½¢å¯è¦–åŒ–ã«åˆ©ç”¨ã§ãã¾ã™ã€‚

## ðŸ“Œ æ¦‚è¦

- **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿**ï¼š  
  å›½åœŸåœ°ç†é™¢ DEM ã‚¿ã‚¤ãƒ«  
  [https://cyberjapandata.gsi.go.jp/xyz/dem/{z}/{x}/{y}.txt](https://cyberjapandata.gsi.go.jp/xyz/dem/{z}/{x}/{y}.txt)

- **å‡ºåŠ›å½¢å¼**ï¼š  
  Mapbox Terrain-RGB å½¢å¼ã® PNG ã‚¿ã‚¤ãƒ«ï¼ˆ`{z}/{x}/{y}.png`ï¼‰

- **å…¥åŠ›æ–¹å¼**ï¼š  
  `target.csv` ã«æŒ‡å®šã•ã‚ŒãŸã‚ºãƒ¼ãƒ ãƒ»Xãƒ»Y ã‚¿ã‚¤ãƒ«ã®ã¿å‡¦ç†

- **ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º**ï¼š  
  256 Ã— 256

- **NoDataã®æ‰±ã„**ï¼š  
  æ¨™é«˜ 0mï¼ˆRGB = `(1, 134, 160)`ï¼‰ã¨ã—ã¦å‡¦ç†

## âœ… ç‰¹å¾´

- `target.csv` ã«è¨˜è¼‰ã•ã‚ŒãŸã‚¿ã‚¤ãƒ«ã ã‘ã‚’ãƒ”ãƒ³ãƒã‚¤ãƒ³ãƒˆã§å‡¦ç†å¯èƒ½
- æ¨™é«˜ `.txt` ã‚¿ã‚¤ãƒ«ã‚’è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- Terrain-RGB å½¢å¼ã§ PNG ã«å¤‰æ›
- ã‚¿ã‚¤ãƒ«éšŽå±¤ `{z}/{x}/{y}` ã«è‡ªå‹•ä¿å­˜
- å‡¦ç†ä¸­ã‚¿ã‚¤ãƒ«ã‚’ãƒ­ã‚°ã§å‡ºåŠ›

## ðŸ§° å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª

ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ `pip` ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼š

```bash
pip install pillow requests
````

## ðŸ“‚ `target.csv` ã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ

å‡¦ç†å¯¾è±¡ã®ã‚¿ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®å½¢å¼ã§è¨˜è¿°ã—ã¦ãã ã•ã„ï¼š

```csv
z,x,y
1,1,0
2,3,1
3,6,3
...
```

## ðŸš€ ä½¿ã„æ–¹

1. `target.csv` ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œï¼š

```bash
python main.py
```

å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®ä¾‹ï¼š

```
dem_txt/
â””â”€â”€ 14/
    â””â”€â”€ 14600/
        â””â”€â”€ 6480.txt

terrain_rgb/
â””â”€â”€ 14/
    â””â”€â”€ 14600/
        â””â”€â”€ 6480.png
```

## ðŸ—ºï¸ Terrain-RGB å½¢å¼ã«ã¤ã„ã¦

å‡ºåŠ›ã•ã‚ŒãŸ PNG ã¯ã€ä»¥ä¸‹ã®å¼ã«åŸºã¥ã„ã¦æ¨™é«˜ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ï¼š

```
æ¨™é«˜ (m) = (R Ã— 256 Ã— 256 + G Ã— 256 + B) Ã— 0.1 - 10000
```

## ðŸ“ æ³¨æ„ç‚¹

* NoDataï¼ˆç©ºæ¬„ã¾ãŸã¯ç„¡åŠ¹å€¤ï¼‰ã¯æ¨™é«˜ `0.0m` ã¨ã—ã¦å‡¦ç†ã•ã‚Œã€RGB = `(1, 134, 160)` ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚
* æ—¥æœ¬å›½å¤–ã®ã‚¿ã‚¤ãƒ«ã‚„å­˜åœ¨ã—ãªã„ã‚¿ã‚¤ãƒ«ã«ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
* é€šä¿¡çŠ¶æ³ã«ã‚ˆã‚Šãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå¤±æ•—ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

## ðŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚‚ã¨ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

> â€» å›½åœŸåœ°ç†é™¢ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€Œå›½åœŸåœ°ç†é™¢ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ©ç”¨è¦ç´„ã€ã«åŸºã¥ã„ã¦ã”åˆ©ç”¨ãã ã•ã„ï¼š
> [https://www.gsi.go.jp/kikakuchousei/kikakuchousei40182.html](https://www.gsi.go.jp/kikakuchousei/kikakuchousei40182.html)

```